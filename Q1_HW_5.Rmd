---
output:
  word_document: default
  html_document: default
---
Consider a binary classification task where the features are high-dimensional. Use
`hw5prob1\_train.txt` as data to train a kernel SVM, and test on `hw5prob1_test.txt` to obtain the
prediction accuracy. In each of the text files, the last column is the response variable.



(a) Fit a SVM procedure with quadratic kernel and report the test misclassification rate.
    Use the `tune` function to pick the best value of `cost`. Try different values of
    `gamme`, e.g. 0.1, 1, 10.
```{r}
library(tidyverse)
train<-read_delim("hw5prob1_train.txt",delim = ",",col_names = FALSE)
test<-read_delim("hw5prob1_test.txt",delim = ",",col_names = FALSE)
library(ggplot2)
train
```

```{r}
library(e1071)

(svm_linear <- svm (X124 ~ ., data = train, kernel = "linear", cost = 10, scale = FALSE))
#(svm_quad<-svm(X124 ~ .,data = train,type ="C-classification", kernel = "polynomial",degree = "4",cost = 10))
                
class_pred = predict(bestmod, test_data)
table(predicted = class_pred, true = test_data$class)
```






```{r}
set.seed(1)
tune_out <- tune(svm, X124 ~ ., data = train, kernel = "linear",
                 ranges = list(cost = c(0.001, 0.01, 0.1, 1, 5, 10, 100)))
summary(tune_out)
bestmod <- tune_out$best.model
summary(bestmod)

```

```{r}
X124_pred = predict(bestmod, test)
table(predicted = X124_pred, true = test$X124)
```

(b) Fit a SVM procedure with radial kernel and report the test misclassification rate.
    Use the `tune` function to pick the best value of `cost`. Try different values of
    `gamme`, e.g. 0.01, 0.1, 1.
```{r}
svm_radial <- svm(X124., data = train, kernel = "radial", gamma = .008, cost = 10)

set.seed(1)
tune_out <- tune(svm, X124 ~ ., data = train, kernel = "radial",
                 ranges = list(cost = c(0.1, 1, 10, 100, 1000), gamma = c(0.1, 0.5, 1, 2, 3, 4)))




bestmod = tune_out$best.model
summary(bestmod)
```

```{r}
#misclassification rate
plot(bestmod, train)
table(true = test$X124, pred = predict(tune_out$best.model, newdata = test))
```

(c) Compare the result of quadratic kernel and radial kernel by constructing ROC curves of
    the best quadratic kernel model and the best radial basis kernel model above.
```{r}
library(ROCR)
rocplot = function(pred, truth, ...){
   predob = prediction(pred, truth)
   perf = performance(predob, "tpr", "fpr")
   plot(perf,...)}

```

```{r}
svmfit_opt = svm(X124~., data = train, kernel = "radial", 
                 gamma = 2, cost = 1, decision.values = TRUE)

fitted_opt_train = attributes(predict(svmfit_opt, train, 
                                      decision.values = TRUE))$decision.values
rocplot(fitted_opt_train, train$X124, main = "Training Data")

```
# I am unable to run in my computer this data set so just Ima submitting the code in R
